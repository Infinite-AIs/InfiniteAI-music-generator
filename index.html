<!DOCTYPE html>
<html>
<head>
  <title>Infinite AI Music</title>
</head>
<body style="font-family: Arial; text-align: center; padding: 40px;">
  <h1>Infinite AI Music Generator</h1>

  <input id="prompt" placeholder="Enter music description..." style="width: 300px; padding: 10px;">
  <button onclick="generate()">Generate</button>

  <p id="status"></p>
  <audio id="player" controls></audio>
<script>
async function generate() {
  const prompt = document.getElementById("prompt").value;
  const status = document.getElementById("status");
  const player = document.getElementById("player");

  status.innerText = "Generating...";
  player.src = "";

  const res = await fetch("/api/generate", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ prompt })
  });

  const contentType = res.headers.get("content-type");
  console.log("Content-Type:", contentType);

  if (contentType && contentType.includes("application/json")) {
    const json = await res.json();
    status.innerText = "Error from API: " + JSON.stringify(json);
    return;
  }

  const blob = await res.blob();
  console.log("Blob type:", blob.type);
  console.log("Blob size:", blob.size);
  console.log("Blob size:", blob.size);

  if (blob.size === 0) {
    status.innerText = "Empty audio returned.";
    return;
  }

  const url = URL.createObjectURL(blob);
  player.src = url;
  status.innerText = "Done!";
}
</script>

</script>
</body>
</html>
